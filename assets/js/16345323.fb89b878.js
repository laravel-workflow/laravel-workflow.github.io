"use strict";(self.webpackChunklaravel_workflow=self.webpackChunklaravel_workflow||[]).push([[7239],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>f});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=r.createContext({}),c=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},u=function(e){var t=c(e.components);return r.createElement(l.Provider,{value:t},e.children)},m="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},p=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,l=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),m=c(n),p=a,f=m["".concat(l,".").concat(p)]||m[p]||d[p]||o;return n?r.createElement(f,s(s({ref:t},u),{},{components:n})):r.createElement(f,s({ref:t},u))}));function f(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,s=new Array(o);s[0]=p;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i[m]="string"==typeof e?e:a,s[1]=i;for(var c=2;c<o;c++)s[c]=n[c];return r.createElement.apply(null,s)}return r.createElement.apply(null,n)}p.displayName="MDXCreateElement"},2987:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>f,contentTitle:()=>d,default:()=>g,frontMatter:()=>m,metadata:()=>p,toc:()=>w});var r=n(7462),a=n(7294),o=n(3905);const s={simulatorWrapper:"simulatorWrapper_K3BJ",expandButton:"expandButton_N9MG",expanded:"expanded_VaC5",expandIcon:"expandIcon_OJAO",simulatorContainer:"simulatorContainer_EJA5",slideDown:"slideDown_BVZS",simulatorHeader:"simulatorHeader_MXKc",simulatorTitle:"simulatorTitle_d2Ha",controls:"controls_Nt9k",playButton:"playButton_B_be",resetButton:"resetButton_Quzc",codeContainer:"codeContainer_maQt",codeBlock:"codeBlock_feiO",codeLine:"codeLine_nCbn",highlighted:"highlighted_arPO",lineNumber:"lineNumber_dzUB",lineContent:"lineContent_hv5D",countdown:"countdown_KN3k",pulse:"pulse_pnhZ",progressSection:"progressSection_yAPk",progressLabel:"progressLabel_B8M8",progressBarContainer:"progressBarContainer_C_RY",progressBar:"progressBar_JXes",statusBar:"statusBar_RxoW",statusIndicator:"statusIndicator_xcAK",idle:"idle_vYL6",running:"running_sYqc",completed:"completed_dAfp"},i="idle",l="running",c="completed";function u(e){let{code:t="use function Workflow\\timer;\nuse Workflow\\Workflow;\n\nclass MyWorkflow extends Workflow\n{\n    public function execute()\n    {\n        yield timer('5 seconds');\n\n        return 'The workflow waited 5 seconds.';\n    }\n}",steps:n=[{line:8,duration:5e3,label:"yield timer('5 seconds')",showCountdown:!0},{line:10,duration:500,label:"return 'The workflow waited 5 seconds.'",showCountdown:!1}],title:r="Timer Execution Simulator"}=e;const[o,u]=(0,a.useState)(!1),[m,d]=(0,a.useState)(i),[p,f]=(0,a.useState)(-1),[w,h]=(0,a.useState)(0),[g,k]=(0,a.useState)(null),y=(0,a.useRef)(null),b=(0,a.useRef)(null),v=t.split("\n"),N=()=>{d(i),f(-1),h(0),k(null),y.current&&cancelAnimationFrame(y.current)};(0,a.useEffect)((()=>()=>{y.current&&cancelAnimationFrame(y.current)}),[]);const E=()=>p>=0&&p<n.length?n[p]:null;return a.createElement("div",{className:s.simulatorWrapper},a.createElement("button",{className:`${s.expandButton} ${o?s.expanded:""}`,onClick:()=>u(!o)},a.createElement("span",{className:s.expandIcon},o?"\u25bc":"\u25b6"),a.createElement("span",null,"Try it out!")),o&&a.createElement("div",{className:s.simulatorContainer},a.createElement("div",{className:s.simulatorHeader},a.createElement("h4",{className:s.simulatorTitle},r),a.createElement("div",{className:s.controls},a.createElement("button",{className:s.playButton,onClick:()=>{N(),d(l),f(0),b.current=performance.now();let e=0,t=performance.now();const r=a=>{if(e>=n.length)return d(c),f(-1),h(100),void k(null);const o=n[e],s=a-t,i=Math.min(s/o.duration*100,100);h(i),f(e);const l=Math.max(0,o.duration-s);k(Math.ceil(l/1e3)),s>=o.duration&&(e++,t=a,e<n.length&&f(e)),e<n.length?y.current=requestAnimationFrame(r):(d(c),f(-1),k(null))};y.current=requestAnimationFrame(r)},disabled:m===l},m===l?"\u23f3 Running...":"\u25b6 Play"),a.createElement("button",{className:s.resetButton,onClick:N,disabled:m===l},"\ud83d\udd04 Reset"))),a.createElement("div",{className:s.codeContainer},a.createElement("pre",{className:s.codeBlock},v.map(((e,t)=>{const n=t+1,r=E(),o=r&&r.line===n;return a.createElement("div",{key:t,className:`${s.codeLine} ${o?s.highlighted:""}`},a.createElement("span",{className:s.lineNumber},n),a.createElement("span",{className:s.lineContent},e||" "),o&&r.showCountdown&&null!==g&&g>0&&a.createElement("span",{className:s.countdown},g,"s"))})))),m===l&&E()&&E().showCountdown&&a.createElement("div",{className:s.progressSection},a.createElement("div",{className:s.progressLabel},"Executing: ",a.createElement("code",null,E().label)),a.createElement("div",{className:s.progressBarContainer},a.createElement("div",{className:s.progressBar,style:{width:`${w}%`}}))),a.createElement("div",{className:s.statusBar},a.createElement("span",{className:`${s.statusIndicator} ${s[m]}`},m===i&&"\u23f8\ufe0f Ready",m===l&&"\u25b6\ufe0f Running",m===c&&"\u2705 Completed"))))}const m={sidebar_position:3},d="Timers",p={unversionedId:"features/timers",id:"features/timers",title:"Timers",description:"Laravel Workflow provides the ability to suspend the execution of a workflow and resume at a later time. These are durable timers, meaning they survive restarts and failures while remaining consistent with workflow replay semantics. This can be useful for implementing delays, retry logic, or timeouts.",source:"@site/docs/features/timers.md",sourceDirName:"features",slug:"/features/timers",permalink:"/docs/features/timers",draft:!1,editUrl:"https://github.com/laravel-workflow/laravel-workflow.github.io/edit/main/docs/features/timers.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"tutorialSidebar",previous:{title:"Queries",permalink:"/docs/features/queries"},next:{title:"Signal + Timer",permalink:"/docs/features/signal+timer"}},f={},w=[{value:"Time Helpers",id:"time-helpers",level:2}],h={toc:w};function g(e){let{components:t,...n}=e;return(0,o.kt)("wrapper",(0,r.Z)({},h,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"timers"},"Timers"),(0,o.kt)("p",null,"Laravel Workflow provides the ability to suspend the execution of a workflow and resume at a later time. These are durable timers, meaning they survive restarts and failures while remaining consistent with workflow replay semantics. This can be useful for implementing delays, retry logic, or timeouts."),(0,o.kt)("p",null,"To use timers, you can use the ",(0,o.kt)("inlineCode",{parentName:"p"},"timer($duration)")," helper function within your workflow. This method returns a ",(0,o.kt)("inlineCode",{parentName:"p"},"Promise")," that will be resolved after the specified duration has passed."),(0,o.kt)("p",null,"Here is an example of using a timer:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-php"},"use function Workflow\\timer;\nuse Workflow\\Workflow;\n\nclass MyWorkflow extends Workflow\n{\n    public function execute()\n    {\n        yield timer('5 seconds');\n\n        return 'The workflow waited 5 seconds.';\n    }\n}\n")),(0,o.kt)(u,{mdxType:"TimerSimulator"}),(0,o.kt)("p",null,"You can specify the ",(0,o.kt)("inlineCode",{parentName:"p"},"$duration")," as an integer number of seconds or as a string e.g. '5 seconds', '30 minutes' or even '3 days'. Laravel Workflow can handle any duration."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Important:")," Inside of a workflow, never use ",(0,o.kt)("inlineCode",{parentName:"p"},"Carbon::now()")," or Laravel's ",(0,o.kt)("inlineCode",{parentName:"p"},"now()")," to get the current time. Instead, use ",(0,o.kt)("inlineCode",{parentName:"p"},"Workflow\\now()"),", which returns the current time as seen by the workflow system. This is crucial because the actual time may not match your application's system clock."),(0,o.kt)("p",null,"Additionally, when measuring elapsed time in workflows (e.g., tracking how long an activity takes), always get your start and end times with:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-php"},"use function Workflow\\{now, sideEffect};\n\n$start = yield sideEffect(fn () => now());\n")),(0,o.kt)("p",null,"This ensures an event log is created, preventing replay-related inconsistencies and guaranteeing accurate time calculations."),(0,o.kt)("h2",{id:"time-helpers"},"Time Helpers"),(0,o.kt)("p",null,"You can also use the following helper functions to create timers for specific units of time:"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"seconds, minutes, hours, days, weeks, months, years")),(0,o.kt)("p",null,"Each function returns a timer promise based on the unit:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-php"},"use function Workflow\\{days, hours};\n\nyield days(3);\nyield hours(2);\n")))}g.isMDXComponent=!0}}]);